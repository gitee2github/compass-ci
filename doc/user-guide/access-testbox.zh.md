# 登录测试机

登录测试机首先需要完成账号注册，并提交job，进行测试机申请。

申请账号请参阅文档：

  apply-account.md

借用测试机请参阅文档：

  borrow-machine.en.md

## 用户登录测试机的情况：

两种情况下，用户需要登录测试机：

  - 提交借用机器job,登录测试机进行操作。
  - 提交job，并添加了‘-i ssh-on-fail.yaml’参数时，若job失败，则允许用户登录测试机进行debug。

以上两种情形，服务器会自动发送测试机登录信息到用户邮箱，方便用户登录。

用户可通过邮件中提供的登录命令，或URL进行登录。

命令行登录：

  ssh root@123.60.114.28 -p 22222

web页面登录：

  https://jumper.compass-ci.openeuler.org/?hostname=123.60.114.28&username=root&port=22222

安全提醒：
  根据安全规范的要求，使用命令行命令登录，需添加白名单才可访问。后续将不再开放命令行登录入口。
  建议用户使用web页面登录测试机。


## 登录认证

测试机只允许使用密钥登录。

公钥在发送‘apply account’邮件进行账号申请时会第一次被自动注册到服务器。
在提交job时，该公钥会自动注册到测试机。
登录测试机需使用与该公钥所匹配的私钥进行登录。

### 密钥更新

如果用户侧私钥发生变化，将导致无法登录到测试机。
此时，需要用户更新新的公钥到服务器。

我们提供了多种方式供用户上传新的公钥：

1. 提交job自动上传
   在提交job的服务器（Linux）本地生成新的公私钥对，提交借用机器的job，job会自动携带公钥($HOME/.ssh/id_rsa.pub)到测试机

2. 邮件上传
   重新发送‘apply account’邮件，并附加新的公钥附件，公钥将自动被更新到服务器。

3. 联系支撑工程师上传
   将新公钥提供给相应的支撑工程师，手动更新到服务器。

秘钥更新后，重新提交job，使用新私钥登录即可。
