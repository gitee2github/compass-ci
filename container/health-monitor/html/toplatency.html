<!DOCTYPE html>
<html>

<head>
    <meta charset="utf-8">
    <title>Top Latency</title>
</head>

<body onload="onload()">

    <h1 style="text-align:center">Compass CI top boot time jobs</h1>
    <hr>
    <div style="width:20%;margin-left:10%;float:left;">
        <table id="tbhw" style="width:100%;" border="1">
            <caption>over boot time jobs on physical</caption>
            <tr>
                <th width="55%">job_id</th>
                <th>boot_time(Sec)</th>
            </tr>
        </table>
    </div>

    <div style="width:20%;margin-left:10%;float:left;">
        <table id="tbdc" style="width:100%;" border="1">
            <caption>over boot time jobs on docker</caption>
            <tr>
                <th width="55%">job_id</th>
                <th>boot_time(Sec)</th>
            </tr>
        </table>
    </div>

    <div style="width:20%;margin-left:10%;float:left;">
        <table id="tbvm" style="width:100%;" border="1">
            <caption>over boot time jobs on virtual machine</caption>
            <tr>
                <th width="55%">job_id</th>
                <th>boot_time(Sec)</th>
            </tr>
        </table>
    </div>

</body>
<script>
    function getdata() {
        var ajax = new XMLHttpRequest();
        ajax.open("post", "/top_boot_time");
        ajax.send();
        ajax.onreadystatechange = function () {
            if (ajax.readyState == 4 && ajax.status == 200) {
                var data = JSON.parse(ajax.responseText);
                showData(data.hw, 'tbhw');
                showData(data.dc, 'tbdc');
                showData(data.vm, 'tbvm');
            }
        }
    };

    function showData(data, tbid) {
        for (var i = 0; i < data.length; i++) {
            var tr = document.createElement('tr');
            document.getElementById(tbid).appendChild(tr);

            var td = document.createElement('td');
            td.style.textAlign = 'center';
            tr.appendChild(td);
            var a = document.createElement('a');
            td.appendChild(a);
            a.innerText = data[i].job_id;
            a.href = data[i].result_root;
            a.target = '_blank';


            var td = document.createElement('td');
            td.style.textAlign = 'center';
            tr.appendChild(td);
            td.innerText = data[i].boot_time;
        }
    };

    function onload() {
        getdata();
    };
</script>

</html>
