#!/bin/sh
# SPDX-License-Identifier: MulanPSL-2.0+

cmd=(
	docker run
	--restart=always
	--name=send-mail
	-u nobody
	-d
	-p 11311:11311
	send-mail
)

"${cmd[@]}"

cat<<EOF
port: 11311
---
data='{
"subject": "mail subject",
"to": "email_to_addr",
"body": "email message"
}'

or

data="
subject: mail subject
to: email_to_addr
body: email message"

when crystal-ci:
	curl -XPOST 'localhost:11311/send_mail_yaml' -d "$data"
when other server:
	curl -XPOST '124.90.34.227:11311/send_mail_yaml' -d "$data"

---
data="
To: mail_address
Subject: mail_subject

mail_msg_line1
mail_msg_line2
...
"

when crystal-ci:
	curl -XPOST 'localhost:11311/send_mail_text' -d "$data"
when other server:
	curl -XPOST '124.90.34.227:11311/send_mail_text' -d "$data"
EOF
